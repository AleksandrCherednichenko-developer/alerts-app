import{L as y,M as I,r as P,R as h,_ as m,o as S,a as k,e as p}from"./index.308755a9.js";import{B as _,t as f,T as u,a as L}from"./toast.00273680.js";const v="posts";class g{static async getPostsList(t,e,s=null){const i=await _.GET({service:v,query:{offset:t,limit:e,search:s}});return i.status.ok?i.payload:(f(u.serverError),null)}static async getPostById(t){const e=await _.GET({service:v,id:t});return e.status.ok?e.payload:(f(u.serverError),null)}static async changePostInfo(t,e){const s=await _.PUT({service:v,id:t,body:e});return s.status.ok?(L(u.postChanging),s.status.ok):(f(u.serverError),null)}static async deletePost(t){const e=await _.DELETE({service:v,id:t});return e.status.ok?(L(u.postDeleted),e.status.ok):(f(u.serverError),null)}}const B=y("loader",()=>{const o=I(),t=P(!1);return{loading:t,startLoad:()=>{t.value=!0},stopLoad:()=>{t.value=!1},respProcessing:async l=>{l||await o.push({name:h.MAIN_PAGE.routeName})}}}),A=y("posts",()=>{const o=P([]),t=P(0),e=P({}),s=B();async function i(r,a,d){if(o.value.length)return;s.startLoad();const n=await g.getPostsList(r,a,d);await s.respProcessing(n),o.value=n.map(c=>({...c,id:String(c.id),userId:String(c.userId)})),t.value=n.length,s.stopLoad()}async function l(r){if(e.value.id===r)return;s.startLoad();const a=await g.getPostById(r);await s.respProcessing(a),e.value=a,s.stopLoad()}async function w(r,a){s.startLoad();const d=await g.changePostInfo(r,a);await s.respProcessing(d);const n=o.value.find(c=>(c==null?void 0:c.id)===r);n.title=a.title,n.body=a.body,s.stopLoad()}async function E(r){s.startLoad();const a=await g.deletePost(r);await s.respProcessing(a);const d=o.value.findIndex(n=>(n==null?void 0:n.id)===r);return o.value.splice(d,1),s.stopLoad(),a}return{postsList:o,totalValue:t,postInfo:e,getPostsList:i,getPostById:l,changePostInfo:w,deletePost:E}});const T={name:"UILoader"},U={class:"loader__wrap"},x=p("div",{class:"loader"},[p("div"),p("div"),p("div"),p("div")],-1),N=[x];function M(o,t,e,s,i,l){return S(),k("div",U,N)}const D=m(T,[["render",M]]);export{D as U,A as a,B as u};
